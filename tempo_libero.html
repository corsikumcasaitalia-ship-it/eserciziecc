<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Tempo Libero - Vado & Faccio</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@300;400;600&family=Pacifico&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #9b59b6;
            --secondary: #3498db;
            --accent: #f1c40f;
            --dark: #2c3e50;
            --light: #ecf0f1;
            --card-bg: #FFFFFF;
            --correct-bg: #d4edda;
            --correct-text: #155724;
        }

        * { box-sizing: border-box; transition: all 0.3s ease; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Fredoka', sans-serif;
            background: var(--light);
            margin: 0;
            display: flex;
            justify-content: center;
            min-height: 100vh;
            color: var(--dark);
        }

        .app-container {
            width: 100%;
            max-width: 480px;
            background: var(--card-bg);
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
        }

        /* Screens */
        .screen { display: none; padding: 20px; flex-grow: 1; flex-direction: column; animation: fadeIn 0.4s ease-out; }
        .screen.active { display: flex; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Login */
        .login-screen {
            justify-content: center; align-items: center; text-align: center;
            background: linear-gradient(135deg, var(--secondary), var(--primary)); color: white;
        }
        .logo { font-family: 'Pacifico', cursive; font-size: 3.5rem; margin-bottom: 10px; text-shadow: 2px 2px 0 rgba(0,0,0,0.2); }
        .login-input { width: 80%; padding: 15px; border-radius: 30px; border: none; text-align: center; font-size: 1.1rem; margin-bottom: 15px; font-family: 'Fredoka', sans-serif; }
        .btn-main { background: var(--dark); color: white; padding: 15px 40px; border-radius: 30px; border: none; font-weight: 600; cursor: pointer; width: 80%; font-size: 1rem; }
        .btn-main:active { transform: scale(0.98); }

        /* Dashboard */
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; }
        .user-badge { background: #eee; padding: 5px 15px; border-radius: 20px; font-size: 0.8rem; font-weight: bold; color: var(--primary); }
        .menu-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .card-btn {
            background: white; border: 2px solid #eee; border-radius: 20px; padding: 15px;
            text-align: center; cursor: pointer; display: flex; flex-direction: column;
            align-items: center; justify-content: center; height: 140px;
        }
        .card-btn:active { background: #f4faff; border-color: var(--secondary); transform: translateY(2px); }
        .card-icon { font-size: 2.5rem; margin-bottom: 10px; }
        .card-title { font-weight: 600; font-size: 0.95rem; margin-bottom: 5px; color: var(--dark); }

        /* Game UI */
        .progress-bar { height: 8px; background: #eee; border-radius: 4px; margin-bottom: 25px; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--secondary), var(--primary)); width: 0%; border-radius: 4px;}

        .question-card {
            background: #fff; border-radius: 20px; padding: 30px 20px; text-align: center;
            box-shadow: 0 8px 25px rgba(0,0,0,0.08); margin-bottom: 25px; border: 1px solid #f0f0f0;
            position: relative; overflow: hidden;
        }
        .emoji-display { font-size: 4rem; margin-bottom: 10px; display: block; animation: bounce 1s infinite alternate; }
        @keyframes bounce { from { transform: translateY(0); } to { transform: translateY(-5px); } }

        .big-text { font-size: 1.3rem; font-weight: 600; color: var(--dark); line-height: 1.3; }

        .options-list { display: flex; flex-direction: column; gap: 12px; }
        .option-btn {
            padding: 16px; background: white; border: 2px solid #e0e0e0; border-radius: 15px;
            font-weight: 600; cursor: pointer; text-align: left; font-size: 1rem; color: #555;
            font-family: 'Fredoka', sans-serif; display: flex; align-items: center; 
        }
        .option-btn.correct { background: var(--correct-bg); border-color: #27ae60; color: var(--correct-text); }
        .option-btn.wrong { background: #f8d7da; border-color: #c0392b; color: #721c24; }

        /* CONJUGATED FEEDBACK STYLING */
        .feedback-area {
            text-align: center; margin-top: 20px; min-height: 60px;
            padding: 15px; border-radius: 15px; font-size: 1rem;
            opacity: 0; transition: opacity 0.3s;
        }
        .feedback-area.visible { opacity: 1; }
        
        .conjugated-sentence {
            display: block;
            font-size: 1.4rem;
            font-weight: 800;
            color: var(--primary);
            margin-top: 5px;
            text-transform: none; /* Keep natural case */
        }
        .verb-highlight { color: #e74c3c; text-decoration: underline; } /* Highlights Vado/Faccio etc */

        .back-btn { background: none; border: none; color: #666; font-size: 1.5rem; cursor: pointer; padding: 5px; }
        
        /* Study List */
        .study-item { display: flex; align-items: center; padding: 15px; background: white; margin-bottom: 10px; border-radius: 15px; border-left: 5px solid var(--secondary); }
        .study-icon { font-size: 2rem; margin-right: 15px; width: 40px; text-align: center; }

    </style>
</head>
<body>

<div class="app-container">
    
    <div id="screen-login" class="screen active login-screen">
        <div class="logo">Tempo Libero</div>
        <p style="opacity:0.9; margin-bottom:30px;">Cosa fai oggi?</p>
        <input type="text" id="username" class="login-input" placeholder="Adƒ±nƒ± yaz...">
        <button class="btn-main" onclick="handleLogin()">Ba≈üla</button>
    </div>

    <div id="screen-dashboard" class="screen">
        <div class="header">
            <div>
                <div style="font-size:0.8rem; color:#888;">Ciao,</div>
                <h2 style="margin:0;" id="display-name">Studente</h2>
            </div>
            <div class="user-badge">PUAN: <span id="total-score">0</span></div>
        </div>

        <h3 style="margin-bottom:10px;">Attivit√†</h3>
        
        <div class="menu-grid">
            <div class="card-btn" onclick="startGame()">
                <div class="card-icon">üéÆ</div>
                <div class="card-title">Cosa fai?</div>
                <div style="font-size:0.75rem; color:#888;">C√ºmle Kurma Oyunu</div>
            </div>

            <div class="card-btn" onclick="showStudy()">
                <div class="card-icon">üìñ</div>
                <div class="card-title">Studio</div>
                <div style="font-size:0.75rem; color:#888;">Fiil √áekimleri</div>
            </div>

             <div class="card-btn" onclick="location.reload()" style="border-color:#ffcccc;">
                <div class="card-icon">üëã</div>
                <div class="card-title">Esci</div>
            </div>
        </div>
    </div>

    <div id="screen-game" class="screen">
        <div class="header">
            <button class="back-btn" onclick="goHome()">‚Üê</button>
            <h3 style="margin:0; font-size:1.1rem;" id="game-title">Cosa fai?</h3>
            <div style="width:30px;"></div>
        </div>

        <div class="progress-bar"><div class="progress-fill" id="progress"></div></div>

        <div class="question-card">
            <div class="emoji-display" id="q-emoji"></div>
            <div class="big-text" id="q-text">Bu aktivite nedir?</div>
        </div>

        <div class="options-list" id="options-container"></div>
        
        <div class="feedback-area" id="feedback">
            <div id="feedback-msg"></div>
            <span class="conjugated-sentence" id="feedback-sentence"></span>
        </div>

        <button id="next-btn" class="btn-main" style="margin-top:auto; display:none; width:100%;" onclick="nextQuestion()">Devam Et ‚Üí</button>
    </div>

    <div id="screen-study" class="screen">
        <div class="header">
            <button class="back-btn" onclick="goHome()">‚Üê</button>
            <h3 style="margin:0;">Io... (Ben...)</h3>
            <div style="width:30px;"></div>
        </div>
        <div style="overflow-y:auto; flex-grow:1; padding-bottom:20px;" id="study-list"></div>
    </div>

</div>

<script>
    // --- VERƒ∞ TABANI (√áekimlenmi≈ü halleriyle) ---
    /* text: Mastar hali (Soruda veya ≈üƒ±kta g√∂r√ºnebilir)
       conjugated: I. Tekil ≈ûahƒ±s √áekimi (Sonu√ßta g√∂r√ºnecek)
       verb: Fiilin k√∂k√º (Vurgulamak i√ßin)
    */
    const activities = [
        { id: 'A', text: "Uscire con gli amici", conjugated: "Esco con gli amici", emoji: "üõµ" },
        { id: 'B', text: "Fare un giro in bici", conjugated: "Faccio un giro in bici", emoji: "üö¥" },
        { id: 'C', text: "Andare in discoteca", conjugated: "Vado in discoteca", emoji: "üíÉ" },
        { id: 'D', text: "Andare in montagna", conjugated: "Vado in montagna", emoji: "üßó" },
        { id: 'E', text: "Navigare in Internet", conjugated: "Navigo in Internet", emoji: "üíª" },
        { id: 'F', text: "Giocare a calcio", conjugated: "Gioco a calcio", emoji: "‚öΩ" },
        { id: 'G', text: "Leggere", conjugated: "Leggo un libro", emoji: "üìñ" },
        { id: 'H', text: "Suonare uno strumento", conjugated: "Suono la chitarra", emoji: "üé∏" },
        { id: 'I', text: "Andare a un concerto", conjugated: "Vado a un concerto", emoji: "üé§" },
        { id: 'L', text: "Andare a una festa", conjugated: "Vado a una festa", emoji: "ü•≥" }
    ];

    let user = "Studente";
    let score = 0;
    let currentQIndex = 0;
    let gameQuestions = [];

    // --- NAVIGASYON ---
    function showScreen(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
    }

    function handleLogin() {
        const val = document.getElementById('username').value.trim();
        if(val) { user = val; document.getElementById('display-name').innerText = user; }
        showScreen('screen-dashboard');
    }

    function goHome() { 
        showScreen('screen-dashboard'); 
        document.getElementById('total-score').innerText = score; 
    }

    // --- √áALI≈ûMA MODU (√ñnce ve Sonra'yƒ± g√∂sterir) ---
    function showStudy() {
        const list = document.getElementById('study-list');
        list.innerHTML = "";
        activities.forEach(item => {
            // Highlight the verb in the conjugated form roughly
            let displaySent = item.conjugated.replace(/^\w+/, (match) => `<span style="color:#d35400; font-weight:bold;">${match}</span>`);
            
            list.innerHTML += `
                <div class="study-item">
                    <div class="study-icon">${item.emoji}</div>
                    <div>
                        <div style="font-size:0.8rem; color:#888;">${item.text}</div>
                        <div style="font-size:1.1rem;">${displaySent}</div>
                    </div>
                </div>
            `;
        });
        showScreen('screen-study');
    }

    // --- OYUN MODU ---
    function startGame() {
        score = 0; currentQIndex = 0;
        
        // Sorularƒ± karƒ±≈ütƒ±r
        gameQuestions = [...activities].sort(() => 0.5 - Math.random()).map(item => {
            // ≈ûƒ±klar (Mastar haliyle kalsƒ±n ki √∂ƒürenci se√ßip c√ºmleye d√∂n√º≈üt√ºrs√ºn)
            let distractors = activities.filter(x => x.id !== item.id).sort(() => 0.5 - Math.random()).slice(0, 2);
            let options = [item, ...distractors].sort(() => 0.5 - Math.random());
            
            return {
                target: item, // Doƒüru cevap objesi
                options: options
            };
        });

        showScreen('screen-game');
        loadQuestion();
    }

    function loadQuestion() {
        const q = gameQuestions[currentQIndex];
        
        document.getElementById('q-emoji').innerText = q.target.emoji;
        // Soru metni
        document.getElementById('q-text').innerText = "Cosa fai?"; 
        document.getElementById('progress').style.width = `${(currentQIndex / gameQuestions.length) * 100}%`;
        
        // Reset Feedback
        const feedbackArea = document.getElementById('feedback');
        feedbackArea.className = 'feedback-area'; // hide visible class
        feedbackArea.style.background = 'transparent';
        document.getElementById('feedback-msg').innerHTML = "";
        document.getElementById('feedback-sentence').innerHTML = "";
        
        document.getElementById('next-btn').style.display = "none";

        // Create Buttons
        const container = document.getElementById('options-container');
        container.innerHTML = "";
        
        q.options.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'option-btn';
            // Buton √ºzerinde hala Mastar hali yazƒ±yor (Andare...)
            // Se√ßince "Vado..." olacak.
            btn.innerHTML = `<span style="margin-left:10px;">${opt.text}</span>`;
            
            btn.onclick = () => checkAnswer(btn, opt, q.target);
            container.appendChild(btn);
        });
    }

    function checkAnswer(btn, selectedItem, correctItem) {
        // Disable all
        document.querySelectorAll('.option-btn').forEach(b => b.disabled = true);
        
        const feedbackArea = document.getElementById('feedback');
        const feedbackMsg = document.getElementById('feedback-msg');
        const feedbackSent = document.getElementById('feedback-sentence');
        
        feedbackArea.classList.add('visible');

        if(selectedItem.id === correctItem.id) {
            btn.classList.add('correct');
            score += 10;
            
            feedbackMsg.innerHTML = "‚úÖ Bravo! Doƒüru s√∂yl√ºyorsun:";
            feedbackArea.style.background = "#e8f5e9";
            
            // BURASI KRƒ∞Tƒ∞K: √áekilmi≈ü halini g√∂ster
            // Fiilin ilk kelimesini vurgula (Vado, Faccio, Esco)
            let sent = correctItem.conjugated;
            let firstSpace = sent.indexOf(' ');
            if(firstSpace === -1) firstSpace = sent.length;
            let verb = sent.substring(0, firstSpace);
            let rest = sent.substring(firstSpace);
            
            feedbackSent.innerHTML = `<span class="verb-highlight">${verb}</span>${rest}`;
            
        } else {
            btn.classList.add('wrong');
            
            // Yanlƒ±≈üta da doƒürusunun √ßekilmi≈ü halini g√∂sterelim
            feedbackMsg.innerHTML = "‚ùå Hayƒ±r... Doƒürusu:";
            feedbackArea.style.background = "#ffebee";
            
            feedbackSent.innerHTML = correctItem.conjugated;
            feedbackSent.style.color = "#c0392b";
            
            // Doƒüru ≈üƒ±kkƒ± i≈üaretle
            document.querySelectorAll('.option-btn').forEach(b => {
                if(b.innerText.includes(correctItem.text)) b.classList.add('correct');
            });
        }
        
        document.getElementById('next-btn').style.display = "block";
    }

    function nextQuestion() {
        currentQIndex++;
        if(currentQIndex < gameQuestions.length) {
            loadQuestion();
        } else {
            endGame();
        }
    }

    function endGame() {
        const container = document.getElementById('options-container');
        document.getElementById('q-text').innerText = "Finito!";
        document.getElementById('q-emoji').innerText = "üèÜ";
        document.getElementById('progress').style.width = "100%";
        document.getElementById('next-btn').style.display = 'none';
        
        // Hide feedback area
        document.getElementById('feedback').classList.remove('visible');

        let message = score > (gameQuestions.length * 10 * 0.7) ? "Harika konu≈ütun! üéâ" : "Tekrar deneyelim mi? üí™";

        container.innerHTML = `
            <div style="text-align:center; padding:20px;">
                <h2 style="font-size:3rem; margin:0; color:var(--primary);">${score}</h2>
                <p style="color:#666;">Puan</p>
                <div style="margin:20px 0; font-weight:bold;">${message}</div>
                <button class="btn-main" onclick="goHome()">Ana Men√º</button>
            </div>
        `;
    }
</script>

</body>
</html>
